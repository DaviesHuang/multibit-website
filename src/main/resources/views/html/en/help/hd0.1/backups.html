<h3>Wallet backups</h3>

<p><strong>So long as you know your wallet words</strong> (seed phrase) you can use a wallet backup to <a href="restore-wallet.html">recover</a>:</p>
<ul>
  <li>your bitcoin</li>
  <li>your contacts and notes</li>
  <li>your payment history and notes.</li>
</ul>

<p><strong>You can always recover your bitcoin <a href="restore-wallet.html">through your wallet words.</a></strong></p>

<p>Hardware and software can fail, be lost or stolen so MultiBit HD ensures that an automatic encrypted backup is made of your wallet
  to a location that you specify.</p>

<p><strong>Data does not exist unless it is in two separate places.</strong></p>

<h4>Use a cloud backup service</h4>

<p>Setting up a cloud backup service is quite straightforward and for small amounts of data (under 2GB) it is often free. We would strongly
  urge you to consider SpiderOak for its end to end encryption. However Dropbox is extremely common and provides an excellent user experience.
  MultiBit HD encrypts all your information locally using a strong AES key derived from your wallet words so it is safe to store the wallet files
  in the cloud without worrying about a malicious administrator being able to read them.</p>

<p>Overall, a good backup is a copy of your wallet file that you regularly store off your computer. That way if something happens to your
  computer you still have access to the backups.</p>

<p>To tell MultiBit HD where your cloud backup is on your computer, use the <a href="edit-wallet.html">"Edit wallet"</a> screen.</p>

<h3>Technical details</h3>

<p>MultiBit HD maintains three stages of wallet backup:</p>
<ul>
  <li>local wallet - this is where changes are made during day to day operations and encrypted with a padded password/Trezor entropy</li>
  <li>rolling backup - this is a copy of the local wallet encrypted with a padded password/Trezor entropy</li>
  <li>cloud backup - this is a ZIP of the wallet directory (less blockchain) encrypted with a key derived from the wallet words and is safe for cloud storage</li>
</ul>

<p>More information on the scheduling of these backups is given later.</p>

<h4>Encrypting "soft" wallets and their backups</h4>

<p>A "soft" wallet is one that is not linked to an external hardware device such as a <a href="https://buytrezor.com?a=4fbc03c60545" target="_blank">Trezor</a>.</p>

<p>The rolling backups encrypt a snapshot of the current wallet. The password is required to unlock the local wallet and is padded to ensure that short passwords do not compromise
  the encryption.</p>

<p>When making a cloud backup we copy the wallet directory and include the wallet password in the archive. This is then encrypted using a key derived from
  the wallet words. This approach allows the password to be recovered from a cloud backup so long as the user knows the wallet words.</p>

<p>It also means that cloud backups are safe for long term off-site storage.</p>

<h4>Encrypting "hard" wallets and their backups</h4>

<p>A "hard" wallet is one that is linked to an external hardware device such as a Trezor. They provide much greater protection for your bitcoins because the
  private keys are never present on your desktop machine and are not susceptible to malware or viruses.</p>

<p>After entering the Trezor PIN number the master public key can be extracted. This is then put through a series of one-way hashes in a similar manner to a Bitcoin
  address: <code>RIPEMD160(SHA256(master public key))</code>. The password for this key is provided by the Trezor encrypting a fixed phrase in a deterministic manner.</p>

<p>Therefore the only way to unlock either the wallet or the backups is to physically have the correct Trezor present and to know its PIN.</p>

<h4>Managing the rolling backups</h4>

<p>MultiBit HD maintains a comprehensive backup strategy consisting of local and cloud backups. While technical in nature
  interested readers may find the following information helpful.</p>

<p>After successfully unlocking a wallet MultiBit HD will follow this process to maintain backups:</p>
<ol>
  <li>Wait 1 minute after MultiBit HD starts and then start "ticking" every 2 minutes.</li>
  <li>Every "tick" (2 minutes), create a rolling wallet backup. This is a copy of the encrypted wallet stored in the
    wallet's <code>rolling-backup</code> sub-directory. It is timestamped and encrypted with the wallet password.
    There are up to 4 of these in place covering the last 8 minutes of activity.
  </li>
  <li>Every "tick modulo 5" (10 minutes), create a zip backup in the wallet <code>zip-backup</code> directory. These
    are the local zip backups. This is everything in the wallet directory except the blockstore (always retrievable from
    the Bitcoin network) and the zip-backups themselves. Note that the rolling backups are put in the zip backup.
    It is actually a zip file which is then AES encrypted using a very long key derived from your wallet words.
  </li>
  <li>Every "tick modulo 15" (30 minutes), copy the just created zip backup to the cloud backup directory if one has
    been set.
  </li>
</ol>

<p>In summary:</p>
<ul>
  <li>Rolling backups are made at 1, 3, 5, 7 ... minutes after start up</li>
  <li>Local zip backups at 1, 11, 21, 31, 41 ... minutes after start up</li>
  <li>Cloud zip backups at 1, 31, 61, 91 ... minutes after start up</li>
</ul>

<p>To avoid excessive unnecessary data storage the rolling backups are pruned, oldest first, when there are more than 4
  backups using a secure delete mechanism.</p>

<p>The local and cloud zip backups are pruned when there are more than 60 using the following process:</p>
<ul>
  <li>The first 2 are always kept</li>
  <li>The last 8 are always kept</li>
  <li>For the remaining, the backup that was most rapidly replaced is secure deleted</li>
</ul>
<p>This approach gradually spaces out the backups so that there is protection for the most recent changes and also the
  ability to go all the way back to the beginning if necessary.</p>

<h4>Related</h4>

<ul>
  <li><a href="restore-password.html">Restore a password</a></li>
  <li><a href="restore-wallet.html">Restore a wallet</a></li>
  <li><a href="edit-wallet.html">Edit wallet</a></li>
</ul>
